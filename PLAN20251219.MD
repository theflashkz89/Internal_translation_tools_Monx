# ğŸ“‹ Internal Translation Tools æ”¹è¿›è®¡åˆ’

**åˆ›å»ºæ—¥æœŸ**: 2024-12-29  
**ç‰ˆæœ¬**: v2.3 è®¡åˆ’  
**ç›®æ ‡**: å®ç°äº”ä¸ªéœ€æ±‚çš„æœ€å°å¯åˆ†è§£æ­¥éª¤  
**Git ä»“åº“**: https://github.com/theflashkz89/Internal-translation-tools

---

## ğŸ“‘ ç›®å½•

1. [å¼€å‘è§„èŒƒ](#å¼€å‘è§„èŒƒ)
2. [éœ€æ±‚æ¦‚è¿°](#éœ€æ±‚æ¦‚è¿°)
3. [ç°æœ‰æ¶æ„åˆ†æ](#ç°æœ‰æ¶æ„åˆ†æ)
4. [éœ€æ±‚ä¸€ï¼šé‚®ä»¶åŠ©æ‰‹é¡µé¢](#éœ€æ±‚ä¸€é‚®ä»¶åŠ©æ‰‹é¡µé¢deepseek-api)
5. [éœ€æ±‚äºŒï¼šä»£ç æ¸…ç†](#éœ€æ±‚äºŒä»£ç æ¸…ç†)
6. [éœ€æ±‚ä¸‰ï¼šå¢åŠ ä¸­æ–‡ç¿»è¯‘é€‰é¡¹](#éœ€æ±‚ä¸‰å¢åŠ ä¸­æ–‡ç¿»è¯‘é€‰é¡¹)
7. [éœ€æ±‚å››ï¼šæœ¯è¯­åº“é‡æ„](#éœ€æ±‚å››æœ¯è¯­åº“é‡æ„)
8. [éœ€æ±‚äº”ï¼šPPTç”ŸæˆåŠŸèƒ½](#éœ€æ±‚äº”pptç”ŸæˆåŠŸèƒ½)
9. [éœ€æ±‚å…­ï¼šUIé—ªçƒä¿®å¤](#éœ€æ±‚å…­uié—ªçƒä¿®å¤)
10. [æ‰§è¡Œé¡ºåºå»ºè®®](#æ‰§è¡Œé¡ºåºå»ºè®®)
11. [æµ‹è¯•è®¡åˆ’](#æµ‹è¯•è®¡åˆ’)

---

## å¼€å‘è§„èŒƒ

### âš ï¸ å¿…é¡»éµå®ˆçš„ä¸‰æ¡è§„åˆ™

| # | è§„åˆ™ | è¯´æ˜ |
|---|------|------|
| 1 | **æ¯æ­¥å¿…æµ‹** | æ¯å®Œæˆä¸€ä¸ªå°æ­¥éª¤ï¼Œå¿…é¡»è¿›è¡ŒåŠŸèƒ½æµ‹è¯•ï¼Œç¡®è®¤æ— è¯¯åå†ç»§ç»­ |
| 2 | **æµ‹è¯•é€šè¿‡åå¿…é¡»æäº¤** | ç”¨æˆ·ç¡®è®¤æµ‹è¯•é€šè¿‡åï¼Œå¿…é¡»æ‰§è¡Œ `git commit` æ›´æ–°ç‰ˆæœ¬æ§åˆ¶ |
| 3 | **æœ€å°æ”¹åŠ¨åŸåˆ™** | åªä¿®æ”¹è®¡åˆ’ä¸­æ˜ç¡®è¦æ±‚çš„éƒ¨åˆ†ï¼Œä¸è§¦ç¢°å…¶ä»–åŠŸèƒ½ä»£ç  |

### ğŸ”„ å•æ­¥éª¤å·¥ä½œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ­¥éª¤ N                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. é˜…è¯»æ­¥éª¤è¦æ±‚                                              â”‚
â”‚  2. å®ç°ä»£ç ä¿®æ”¹                                              â”‚
â”‚  3. æœ¬åœ°æµ‹è¯•éªŒè¯                                              â”‚
â”‚  4. ç”¨æˆ·ç¡®è®¤é€šè¿‡                                              â”‚
â”‚  5. git add + git commit -m "æ­¥éª¤ N: ç®€è¦æè¿°"               â”‚
â”‚  6. è¿›å…¥ä¸‹ä¸€æ­¥éª¤                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“ Git Commit è§„èŒƒ

æ¯ä¸ªæ­¥éª¤å®Œæˆåï¼Œä½¿ç”¨ä»¥ä¸‹æ ¼å¼æäº¤ï¼š

```bash
git add .
git commit -m "feat(æ¨¡å—): æ­¥éª¤æè¿°"
```

**Commit Message ç±»å‹**ï¼š
- `feat`: æ–°åŠŸèƒ½
- `fix`: ä¿®å¤é—®é¢˜
- `refactor`: ä»£ç é‡æ„ï¼ˆä¸æ”¹å˜åŠŸèƒ½ï¼‰
- `chore`: æ„å»º/å·¥å…·å˜æ›´
- `docs`: æ–‡æ¡£æ›´æ–°

**ç¤ºä¾‹**ï¼š
```bash
# ä»£ç æ¸…ç†
git commit -m "refactor(utils): ç§»é™¤æ­»ä»£ç å’Œè°ƒè¯•è¯­å¥"

# æ–°åŠŸèƒ½
git commit -m "feat(ppt): å®ç° PPT å†…å®¹è§£æå‡½æ•°"

# å¢åŠ é€‰é¡¹
git commit -m "feat(translate): å¢åŠ ä¸­æ–‡ç¿»è¯‘é€‰é¡¹"
```

### ğŸš« ç¦æ­¢äº‹é¡¹

1. âŒ ä¸è¦ä¿®æ”¹è®¡åˆ’å¤–çš„æ–‡ä»¶
2. âŒ ä¸è¦é‡æ„è®¡åˆ’å¤–çš„ä»£ç ç»“æ„
3. âŒ ä¸è¦"é¡ºä¾¿"ä¼˜åŒ–å…¶ä»–åŠŸèƒ½
4. âŒ ä¸è¦è·³è¿‡æµ‹è¯•ç›´æ¥è¿›å…¥ä¸‹ä¸€æ­¥
5. âŒ ä¸è¦åˆå¹¶å¤šä¸ªæ­¥éª¤çš„ä¿®æ”¹åˆ°ä¸€ä¸ª commit

### âœ… æµ‹è¯•æ£€æŸ¥æ¸…å•

æ¯ä¸ªæ­¥éª¤å®Œæˆåï¼Œç¡®è®¤ä»¥ä¸‹å†…å®¹ï¼š

- [ ] ä¿®æ”¹çš„åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- [ ] æœªä¿®æ”¹çš„åŠŸèƒ½ä»ç„¶æ­£å¸¸ï¼ˆå›å½’æµ‹è¯•ï¼‰
- [ ] æ— æ–°çš„é”™è¯¯æˆ–è­¦å‘Š
- [ ] ä»£ç å¯ä»¥æ­£å¸¸å¯åŠ¨ (`streamlit run app.py`)

---

## éœ€æ±‚æ¦‚è¿°

| éœ€æ±‚ç¼–å· | æè¿° | API ä¾èµ– | ä¼˜å…ˆçº§ | çŠ¶æ€ |
|---------|------|---------|-------|------|
| 1 | æ–°å¢é‚®ä»¶åŠ©æ‰‹é¡µé¢ï¼ŒååŠ©æ’°å†™ Email Draft | DeepSeek API | é«˜ | âœ… å·²å®Œæˆ |
| 2 | ä»£ç æ¸…ç†ï¼Œç§»é™¤æ— ç”¨ä»£ç å’Œæ³¨é‡Š | æ—  | ä¸­ | âœ… å·²å®Œæˆ |
| 3 | ç¿»è¯‘åŠŸèƒ½å¢åŠ "ä¸­æ–‡"é€‰é¡¹ | DeepL API | é«˜ | âœ… å·²å®Œæˆ |
| 4 | æœ¯è¯­åº“é‡æ„ï¼Œæ¸…ç†ç¡¬ç¼–ç å­—å…¸ | æ—  | ä¸­ | âœ… å·²å®Œæˆ |
| 5 | å®ç° PPT ç”ŸæˆåŠŸèƒ½ï¼ˆMarkdown â†’ PPTXï¼‰ | æ—  | é«˜ | âœ… å·²å®Œæˆ |
| 6 | ä¿®å¤ UI é—ªçƒé—®é¢˜ | æ—  | é«˜ | âœ… å·²å®Œæˆ |

---

## ç°æœ‰æ¶æ„åˆ†æ

### æ–‡ä»¶ç»“æ„
```
â”œâ”€â”€ app.py                    # ä¸»åº”ç”¨å…¥å£ï¼ˆä¾§è¾¹æ å¯¼èˆªç‰ˆæœ¬ï¼‰
â”œâ”€â”€ run_app.py                # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ utils.py                  # æ ¸å¿ƒå·¥å…·å‡½æ•°ï¼ˆç¿»è¯‘ã€PDFå¤„ç†ç­‰ï¼‰
â”œâ”€â”€ ai_service.py             # AI æœåŠ¡å°è£…ï¼ˆDeepSeekï¼‰- å½“å‰æœªä½¿ç”¨
â”œâ”€â”€ config.py                 # é…ç½®æ–‡ä»¶
â”œâ”€â”€ glossary.json             # æœ¯è¯­åº“æ–‡ä»¶ï¼ˆå¤–éƒ¨JSONï¼‰
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ 1_æ–‡æœ¬ç¿»è¯‘.py          # æ–‡æœ¬ç¿»è¯‘é¡µé¢
â”‚   â”œâ”€â”€ 2_æ–‡æ¡£ç¿»è¯‘.py          # æ–‡æ¡£ç¿»è¯‘é¡µé¢
â”‚   â”œâ”€â”€ 3_PPTç”Ÿæˆ.py           # PPTç”Ÿæˆé¡µé¢
â”‚   â””â”€â”€ 4_é‚®ä»¶åŠ©æ‰‹.py          # é‚®ä»¶åŠ©æ‰‹é¡µé¢ï¼ˆDeepSeek APIï¼‰
â””â”€â”€ .streamlit/
    â””â”€â”€ secrets.toml          # API Keys é…ç½®
```

### API ä½¿ç”¨æƒ…å†µ
- **DeepL API**: ç”¨äºæ–‡æœ¬ç¿»è¯‘å’Œæ–‡æ¡£ç¿»è¯‘ï¼ˆ`utils.py` ä¸­çš„ `call_deepl_api`ï¼‰
- **DeepSeek API**: ç”¨äº AI åŠŸèƒ½ï¼ˆ`utils.py` ä¸­çš„ `call_deepseek_api`ï¼‰
- **API Keys**: å­˜å‚¨åœ¨ `.streamlit/secrets.toml`

### å‘ç°çš„é—®é¢˜

| é—®é¢˜ | æ–‡ä»¶ä½ç½® | æè¿° |
|-----|---------|------|
| æ­»ä»£ç  | `utils.py:374-375` | `return` è¯­å¥åçš„ä¸å¯è¾¾ä»£ç  |
| æ®‹ç•™æ³¨é‡Š | `pages/1_æ–‡æœ¬ç¿»è¯‘.py:1` | `# ... imports remain the same ...` |
| è°ƒè¯•è¯­å¥ | `utils.py:347`, `pages/2_æ–‡æ¡£ç¿»è¯‘.py:234` | è°ƒè¯•ç”¨ `print` è¯­å¥ |
| å†—ä½™ç©ºè¡Œ | `ai_service.py:163-166`, `config.py:42-43`, `glossary.json` æœ«å°¾ | æ–‡ä»¶æœ«å°¾å¤šä½™ç©ºè¡Œ |
| æœªä½¿ç”¨æ¨¡å— | `ai_service.py` | æ•´ä¸ªæ–‡ä»¶æœªè¢«é¡¹ç›®ä½¿ç”¨ |
| å†—é•¿æ³¨é‡Š | `pages/1_æ–‡æœ¬ç¿»è¯‘.py:57-82` | CSS æ³¨é‡Šå—è¿‡äºå†—é•¿ |
| æœ¯è¯­åº“é‡å¤ | `utils.py:61-78` + `glossary.json` | ç¡¬ç¼–ç å­—å…¸ä¸ JSON æ–‡ä»¶é‡å¤ä¸”æ•°æ®ä¸ä¸€è‡´ |
| **UI é—ªçƒ** | `app.py` / `pages/*.py` | å¯åŠ¨æ—¶çŸ­æš‚æ˜¾ç¤ºæ—§ç‰ˆ UI åæ‰è·³è½¬åˆ°æ­£å¸¸ UI |

---

## éœ€æ±‚ä¸€ï¼šé‚®ä»¶åŠ©æ‰‹é¡µé¢ï¼ˆDeepSeek APIï¼‰

### åŠŸèƒ½è®¾è®¡

ç”¨æˆ·å¯ä»¥é€šè¿‡è¯¥é¡µé¢ï¼š
1. è¾“å…¥é‚®ä»¶çš„åŸºæœ¬ä¿¡æ¯ï¼ˆæ”¶ä»¶äººã€ä¸»é¢˜ã€èƒŒæ™¯/è¦ç‚¹ï¼‰
2. é€‰æ‹©é‚®ä»¶ç±»å‹å’Œè¯­æ°”
3. AI è‡ªåŠ¨ç”Ÿæˆé‚®ä»¶è‰ç¨¿
4. æ”¯æŒå¤åˆ¶å’Œå†æ¬¡ç”Ÿæˆ

### æ­¥éª¤åˆ†è§£

#### æ­¥éª¤ 1.1ï¼šåˆ›å»ºé¡µé¢æ–‡ä»¶
- **æ–‡ä»¶**: `pages/4_é‚®ä»¶åŠ©æ‰‹.py`
- **æ“ä½œ**: åˆ›å»ºæ–°æ–‡ä»¶
- **å†…å®¹**: åŸºç¡€é¡µé¢æ¡†æ¶ï¼ˆå‚è€ƒç°æœ‰é¡µé¢ç»“æ„ï¼‰

```python
# åŸºç¡€æ¡†æ¶
import streamlit as st
from utils import apply_custom_styles, call_deepseek_api

st.set_page_config(
    page_title="é‚®ä»¶åŠ©æ‰‹",
    page_icon="âœ‰ï¸",
    layout="wide"
)

apply_custom_styles()
st.title("âœ‰ï¸ é‚®ä»¶åŠ©æ‰‹")
```

#### æ­¥éª¤ 1.2ï¼šè®¾è®¡ UI å¸ƒå±€
- **æ“ä½œ**: æ·»åŠ è¾“å…¥ç»„ä»¶
- **ç»„ä»¶åˆ—è¡¨**:
  - `st.selectbox`: é‚®ä»¶ç±»å‹ï¼ˆå•†åŠ¡é‚®ä»¶ã€æ„Ÿè°¢ä¿¡ã€è¯·æ±‚é‚®ä»¶ã€é€šçŸ¥é‚®ä»¶ã€å›å¤é‚®ä»¶ï¼‰
  - `st.selectbox`: è¯­æ°”é£æ ¼ï¼ˆæ­£å¼ã€å‹å¥½ã€ç®€æ´ã€ç¤¼è²Œï¼‰
  - `st.selectbox`: é‚®ä»¶è¯­è¨€ï¼ˆä¸­æ–‡ã€è‹±æ–‡ï¼‰
  - `st.text_input`: æ”¶ä»¶äººç§°å‘¼ï¼ˆå¯é€‰ï¼‰
  - `st.text_input`: é‚®ä»¶ä¸»é¢˜
  - `st.text_area`: å…³é”®è¦ç‚¹/èƒŒæ™¯ä¿¡æ¯

#### æ­¥éª¤ 1.3ï¼šæ„å»º Prompt æ¨¡æ¿
- **æ“ä½œ**: åœ¨ `utils.py` ä¸­æ·»åŠ é‚®ä»¶ç”Ÿæˆå‡½æ•°
- **å‡½æ•°å**: `generate_email_draft()`
- **å‚æ•°**: email_type, tone, language, recipient, subject, key_points
- **è¿”å›**: ç”Ÿæˆçš„é‚®ä»¶è‰ç¨¿

```python
def generate_email_draft(
    email_type: str,
    tone: str, 
    language: str,
    recipient: str,
    subject: str,
    key_points: str
) -> str:
    """
    ä½¿ç”¨ DeepSeek API ç”Ÿæˆé‚®ä»¶è‰ç¨¿
    """
    # æ„å»ºç³»ç»Ÿæç¤ºè¯
    system_prompt = f"""ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„å•†åŠ¡å†™ä½œåŠ©æ‰‹ã€‚
è¯·æ ¹æ®ç”¨æˆ·æä¾›çš„ä¿¡æ¯ï¼Œæ’°å†™ä¸€å°{email_type}ã€‚
è¦æ±‚ï¼š
- è¯­æ°”ï¼š{tone}
- è¯­è¨€ï¼š{language}
- æ ¼å¼è§„èŒƒï¼Œç»“æ„æ¸…æ™°
- åªè¾“å‡ºé‚®ä»¶æ­£æ–‡ï¼Œä¸è¦æ·»åŠ é¢å¤–è¯´æ˜"""
    
    # æ„å»ºç”¨æˆ·è¾“å…¥
    user_input = f"""è¯·æ’°å†™ä¸€å°é‚®ä»¶ï¼š
æ”¶ä»¶äººç§°å‘¼ï¼š{recipient if recipient else 'ï¼ˆæœªæŒ‡å®šï¼‰'}
é‚®ä»¶ä¸»é¢˜ï¼š{subject}
å…³é”®è¦ç‚¹ï¼š
{key_points}"""
    
    return call_deepseek_api(user_input, system_prompt)
```

#### æ­¥éª¤ 1.4ï¼šå®ç°ç”Ÿæˆé€»è¾‘
- **æ“ä½œ**: åœ¨é¡µé¢ä¸­æ·»åŠ ç”ŸæˆæŒ‰é’®å’Œç»“æœå±•ç¤º
- **åŠŸèƒ½**:
  - ç‚¹å‡»"ç”Ÿæˆé‚®ä»¶"æŒ‰é’®è°ƒç”¨ API
  - æ˜¾ç¤ºç”Ÿæˆç»“æœ
  - æä¾›"å¤åˆ¶"å’Œ"é‡æ–°ç”Ÿæˆ"æŒ‰é’®

#### æ­¥éª¤ 1.5ï¼šæ·»åŠ å¤åˆ¶åŠŸèƒ½
- **æ“ä½œ**: å‚è€ƒ `pages/1_æ–‡æœ¬ç¿»è¯‘.py` çš„å¤åˆ¶æŒ‰é’®å®ç°
- **ä½¿ç”¨**: JavaScript + `streamlit.components.v1`

#### æ­¥éª¤ 1.6ï¼šæ›´æ–°ä¾§è¾¹æ å¯¼èˆª
- **æ–‡ä»¶**: `app.py`
- **æ“ä½œ**: åœ¨ `st.radio` é€‰é¡¹ä¸­æ·»åŠ "âœ‰ï¸ é‚®ä»¶åŠ©æ‰‹"
- **æ·»åŠ **: å¯¹åº”çš„é¡µé¢é€»è¾‘åˆ†æ”¯

---

## éœ€æ±‚äºŒï¼šä»£ç æ¸…ç†

### æ­¥éª¤åˆ†è§£

#### æ­¥éª¤ 2.1ï¼šæ¸…ç† utils.py ä¸­çš„æ­»ä»£ç 
- **æ–‡ä»¶**: `utils.py`
- **ä½ç½®**: ç¬¬ 374-375 è¡Œ
- **æ“ä½œ**: åˆ é™¤ä¸å¯è¾¾ä»£ç 

```python
# åˆ é™¤ä»¥ä¸‹ä¸¤è¡Œï¼ˆåœ¨ except å—åçš„ return å‰æ°¸è¿œä¸ä¼šæ‰§è¡Œï¼‰
print(f"DeepL Translation Success: {result.text[:50]}...")
return result.text
```

#### æ­¥éª¤ 2.2ï¼šæ¸…ç†è°ƒè¯•ç”¨ print è¯­å¥
- **æ–‡ä»¶**: `utils.py`
- **ä½ç½®**: ç¬¬ 347 è¡Œ
- **æ“ä½œ**: åˆ é™¤æˆ–æ³¨é‡Šæ‰

```python
# åˆ é™¤
print(f"Calling DeepL API with text length: {len(text)}, target: {target_lang}")
```

- **æ–‡ä»¶**: `pages/2_æ–‡æ¡£ç¿»è¯‘.py`
- **ä½ç½®**: ç¬¬ 234 è¡Œ
- **æ“ä½œ**: åˆ é™¤

```python
# åˆ é™¤
print(f"DEBUG: Generated Download Filename: {download_filename}")
```

#### æ­¥éª¤ 2.3ï¼šæ¸…ç†æ®‹ç•™æ³¨é‡Š
- **æ–‡ä»¶**: `pages/1_æ–‡æœ¬ç¿»è¯‘.py`
- **ä½ç½®**: ç¬¬ 1 è¡Œ
- **æ“ä½œ**: åˆ é™¤æ— æ„ä¹‰æ³¨é‡Š

```python
# åˆ é™¤
# ... imports remain the same ...
```

- **æ–‡ä»¶**: `pages/1_æ–‡æœ¬ç¿»è¯‘.py`
- **ä½ç½®**: ç¬¬ 57-82 è¡Œ
- **æ“ä½œ**: ç²¾ç®€ CSS æ³¨é‡Šå—ï¼Œåªä¿ç•™å¿…è¦è¯´æ˜

#### æ­¥éª¤ 2.4ï¼šæ¸…ç†æ–‡ä»¶æœ«å°¾ç©ºè¡Œ
- **æ–‡ä»¶**: `ai_service.py`
- **ä½ç½®**: ç¬¬ 163-166 è¡Œ
- **æ“ä½œ**: åˆ é™¤å¤šä½™ç©ºè¡Œï¼Œä¿ç•™ä¸€ä¸ª

- **æ–‡ä»¶**: `config.py`
- **ä½ç½®**: ç¬¬ 42-43 è¡Œ
- **æ“ä½œ**: åˆ é™¤å¤šä½™ç©ºè¡Œ

- **æ–‡ä»¶**: `pages/1_æ–‡æœ¬ç¿»è¯‘.py`
- **ä½ç½®**: ç¬¬ 248-249 è¡Œ
- **æ“ä½œ**: åˆ é™¤å¤šä½™ç©ºè¡Œ

- **æ–‡ä»¶**: `glossary.json`
- **ä½ç½®**: æ–‡ä»¶æœ«å°¾
- **æ“ä½œ**: åˆ é™¤å¤šä½™ç©ºè¡Œ

#### æ­¥éª¤ 2.5ï¼šè¯„ä¼° ai_service.py çš„ä¿ç•™ä»·å€¼
- **åˆ†æ**: è¯¥æ–‡ä»¶å®šä¹‰äº† `AIService` ç±»ï¼Œä½†é¡¹ç›®å®é™…ä½¿ç”¨çš„æ˜¯ `utils.py` ä¸­çš„ `call_deepseek_api()` å‡½æ•°
- **å»ºè®®**: æš‚æ—¶ä¿ç•™ï¼Œå¯ä½œä¸ºæœªæ¥æ‰©å±•çš„å°è£…å±‚
- **æ“ä½œ**: åœ¨æ–‡ä»¶é¡¶éƒ¨æ·»åŠ è¯´æ˜æ³¨é‡Šï¼Œè¡¨æ˜å½“å‰æœªä½¿ç”¨

```python
"""
AI æœåŠ¡æ¨¡å—
è´Ÿè´£ä¸ DeepSeek API çš„äº¤äº’

æ³¨æ„ï¼šå½“å‰ç‰ˆæœ¬ä¸»è¦ä½¿ç”¨ utils.py ä¸­çš„ call_deepseek_api() å‡½æ•°
æœ¬æ¨¡å—ä½œä¸ºæœªæ¥æ‰©å±•çš„å¤‡é€‰å°è£…å±‚ä¿ç•™
"""
```

#### æ­¥éª¤ 2.6ï¼šæ£€æŸ¥å¹¶ç»Ÿä¸€ä»£ç é£æ ¼
- **æ£€æŸ¥é¡¹**:
  - å‡½æ•°æ–‡æ¡£å­—ç¬¦ä¸²æ ¼å¼ä¸€è‡´æ€§
  - å¼‚å¸¸å¤„ç†çš„é”™è¯¯ä¿¡æ¯æ ¼å¼
  - å¯¼å…¥è¯­å¥çš„ç»„ç»‡é¡ºåº

---

## éœ€æ±‚ä¸‰ï¼šå¢åŠ ä¸­æ–‡ç¿»è¯‘é€‰é¡¹

### èƒŒæ™¯çŸ¥è¯†
DeepL API æ”¯æŒçš„ä¸­æ–‡è¯­è¨€ä»£ç ï¼š
- `ZH`: ç®€ä½“ä¸­æ–‡ï¼ˆä»…ä½œä¸ºç›®æ ‡è¯­è¨€ï¼‰
- æ³¨æ„ï¼šDeepL å…è´¹ç‰ˆå¯èƒ½æœ‰è¯­è¨€é™åˆ¶

### æ­¥éª¤åˆ†è§£

#### æ­¥éª¤ 3.1ï¼šæ›´æ–°è¯­è¨€æ˜ å°„å‡½æ•°
- **æ–‡ä»¶**: `utils.py`
- **å‡½æ•°**: `_get_deepl_lang_code()`
- **ä½ç½®**: ç¬¬ 278-311 è¡Œ
- **æ“ä½œ**: åœ¨ `language_map` å­—å…¸ä¸­æ·»åŠ ä¸­æ–‡

```python
language_map = {
    "ä¸­æ–‡": "ZH",           # æ–°å¢
    "ç®€ä½“ä¸­æ–‡": "ZH",       # æ–°å¢ï¼ˆåˆ«åï¼‰
    "è‹±è¯­": "EN-US",
    "æ—¥è¯­": "JA",
    # ... å…¶ä»–è¯­è¨€ä¿æŒä¸å˜
}
```

#### æ­¥éª¤ 3.2ï¼šæ›´æ–° app.py çš„è¯­è¨€é€‰é¡¹
- **æ–‡ä»¶**: `app.py`
- **ä½ç½®**: ç¬¬ 30-35 è¡Œï¼ˆæ–‡æœ¬ç¿»è¯‘è¯­è¨€åˆ—è¡¨ï¼‰
- **æ“ä½œ**: åœ¨åˆ—è¡¨å¼€å¤´æ·»åŠ "ä¸­æ–‡"

```python
target_lang = st.selectbox(
    "ç›®æ ‡è¯­è¨€", 
    ["ä¸­æ–‡", "è‹±è¯­", "æ—¥è¯­", "æ³•è¯­", "å¾·è¯­", "è¥¿ç­ç‰™è¯­", "ä¿„è¯­", "éŸ©è¯­"],  # æ·»åŠ ä¸­æ–‡
    index=1,  # é»˜è®¤é€‰æ‹©è‹±è¯­
    key="text_lang"
)
```

- **ä½ç½®**: ç¬¬ 64-69 è¡Œï¼ˆæ–‡æ¡£ç¿»è¯‘è¯­è¨€åˆ—è¡¨ï¼‰
- **æ“ä½œ**: æ·»åŠ "ä¸­æ–‡"

```python
target_lang_doc = st.selectbox(
    "æ–‡æ¡£ç›®æ ‡è¯­è¨€", 
    ["ä¸­æ–‡", "è‹±è¯­", "æ—¥è¯­", "æ³•è¯­", "å¾·è¯­"],  # æ·»åŠ ä¸­æ–‡
    index=1,
    key="doc_lang"
)
```

#### æ­¥éª¤ 3.3ï¼šæ›´æ–° pages/1_æ–‡æœ¬ç¿»è¯‘.py çš„è¯­è¨€é€‰é¡¹
- **æ–‡ä»¶**: `pages/1_æ–‡æœ¬ç¿»è¯‘.py`
- **ä½ç½®**: ç¬¬ 119-125 è¡Œ
- **æ“ä½œ**: åœ¨åˆ—è¡¨å¼€å¤´æ·»åŠ "ä¸­æ–‡"

```python
languages = [
    "ä¸­æ–‡",     # æ–°å¢
    "è‹±è¯­", "æ—¥è¯­", "éŸ©è¯­", "æ³•è¯­", "å¾·è¯­", 
    "è¥¿ç­ç‰™è¯­", "ä¿„è¯­", "æ„å¤§åˆ©è¯­", "è‘¡è„ç‰™è¯­", "é˜¿æ‹‰ä¼¯è¯­",
    "æ³°è¯­", "è¶Šå—è¯­", "å°å°¼è¯­", "è·å…°è¯­", "ç‘å…¸è¯­",
    "æŒªå¨è¯­", "ä¸¹éº¦è¯­", "èŠ¬å…°è¯­", "æ³¢å…°è¯­", "åœŸè€³å…¶è¯­"
]
```

#### æ­¥éª¤ 3.4ï¼šæ›´æ–° pages/2_æ–‡æ¡£ç¿»è¯‘.py çš„è¯­è¨€é€‰é¡¹
- **æ–‡ä»¶**: `pages/2_æ–‡æ¡£ç¿»è¯‘.py`
- **ä½ç½®**: ç¬¬ 19-24 è¡Œ
- **æ“ä½œ**: åœ¨åˆ—è¡¨å¼€å¤´æ·»åŠ "ä¸­æ–‡"

```python
target_language = st.selectbox(
    "ğŸ¯ é€‰æ‹©ç›®æ ‡è¯­è¨€",
    ["ä¸­æ–‡", "è‹±è¯­", "æ—¥è¯­", "æ³•è¯­", "å¾·è¯­", "è¥¿ç­ç‰™è¯­", "ä¿„è¯­", "éŸ©è¯­", "æ„å¤§åˆ©è¯­", "è‘¡è„ç‰™è¯­", "é˜¿æ‹‰ä¼¯è¯­"],
    index=1  # é»˜è®¤é€‰æ‹©è‹±è¯­
)
```

#### æ­¥éª¤ 3.5ï¼šå¤„ç†æœ¯è¯­åº“é€»è¾‘
- **æ–‡ä»¶**: `utils.py`
- **åˆ†æ**: å½“å‰æœ¯è¯­åº“ï¼ˆGLOSSARYï¼‰ä»…æ”¯æŒä¸­æ–‡â†’è‹±æ–‡æ–¹å‘
- **å½±å“**: ç¿»è¯‘åˆ°ä¸­æ–‡æ—¶ï¼Œæœ¯è¯­åº“ä¸åº”ç”Ÿæ•ˆ
- **æ£€æŸ¥**: `call_deepl_api()` å’Œ `call_deepl_api_batch()` ä¸­å·²æœ‰åˆ¤æ–­é€»è¾‘
  - ç¬¬ 339 è¡Œ: `if target_lang.upper().startswith("EN") and text_stripped in GLOSSARY`
  - ç¬¬ 403 è¡Œ: `is_target_english = target_lang.upper().startswith("EN")`
- **ç»“è®º**: ç°æœ‰é€»è¾‘å·²æ­£ç¡®å¤„ç†ï¼Œæ— éœ€é¢å¤–ä¿®æ”¹

---

## éœ€æ±‚å››ï¼šæœ¯è¯­åº“é‡æ„

### é—®é¢˜åˆ†æ

å½“å‰æœ¯è¯­åº“å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š
1. **æ•°æ®é‡å¤**: `utils.py` ç¬¬ 61-78 è¡Œæœ‰ç¡¬ç¼–ç çš„ `GLOSSARY` å­—å…¸
2. **å¤–éƒ¨æ–‡ä»¶**: `glossary.json` ä¹Ÿæœ‰æœ¯è¯­åº“æ•°æ®
3. **æ•°æ®ä¸ä¸€è‡´**: ä¸¤è¾¹å†…å®¹ä¸å®Œå…¨ä¸€è‡´
   - `utils.py`: `"æ³¨é”€": "Deregistrated"`ï¼ˆæ‹¼å†™é”™è¯¯ï¼‰
   - `glossary.json`: `"æ³¨é”€": "Cancelled"`
4. **å¤šä½™å†…å®¹**: `glossary.json` æœ«å°¾æœ‰å¤šä½™ç©ºè¡Œ

### æ­¥éª¤åˆ†è§£

#### æ­¥éª¤ 4.1ï¼šæ¸…ç† glossary.json æœ«å°¾ç©ºè¡Œ
- **æ–‡ä»¶**: `glossary.json`
- **æ“ä½œ**: åˆ é™¤æ–‡ä»¶æœ«å°¾çš„å¤šä½™ç©ºè¡Œ

```json
{
  "ç»Ÿä¸€ç¤¾ä¼šä¿¡ç”¨ä»£ç ": "Unified Social Credit Code",
  ...
  "å‚ä¿äººæ•°": "Insured Person Count"
}
```

#### æ­¥éª¤ 4.2ï¼šç§»é™¤ utils.py ä¸­çš„ç¡¬ç¼–ç  GLOSSARY å­—å…¸
- **æ–‡ä»¶**: `utils.py`
- **ä½ç½®**: ç¬¬ 58-78 è¡Œ
- **æ“ä½œ**: 
  1. åˆ é™¤ç¡¬ç¼–ç çš„ `GLOSSARY` å­—å…¸å®šä¹‰
  2. å°† `GLOSSARY` åˆå§‹åŒ–ä¸ºç©ºå­—å…¸
  3. ä¿®æ”¹ `load_glossary()` çš„è°ƒç”¨é€»è¾‘

**ä¿®æ”¹å‰**:
```python
# æœ¬åœ°æœ¯è¯­åº“ï¼šä¼ä¸šä¿¡ç”¨æŠ¥å‘Šå¸¸ç”¨æœ¯è¯­ï¼ˆä¸­æ–‡ -> è‹±æ–‡ï¼‰
# ç”¨äºå‡å°‘ API è°ƒç”¨å¹¶æé«˜ç¿»è¯‘å‡†ç¡®åº¦
# é»˜è®¤æœ¯è¯­åº“ï¼ˆå¦‚æœå¤–éƒ¨æ–‡ä»¶åŠ è½½å¤±è´¥æ—¶ä½¿ç”¨ï¼‰
GLOSSARY = {
    'ç»Ÿä¸€ç¤¾ä¼šä¿¡ç”¨ä»£ç ': 'Unified Social Credit Code',
    ...
    'æ³¨é”€': 'Deregistrated'
}
```

**ä¿®æ”¹å**:
```python
# æœ¯è¯­åº“ï¼šä» glossary.json åŠ è½½
# ç”¨äºå‡å°‘ API è°ƒç”¨å¹¶æé«˜ç¿»è¯‘å‡†ç¡®åº¦
GLOSSARY = {}


def _init_glossary():
    """
    åˆå§‹åŒ–æœ¯è¯­åº“ï¼ˆä» glossary.json åŠ è½½ï¼‰
    """
    global GLOSSARY
    if not GLOSSARY:
        GLOSSARY = load_glossary()
```

#### æ­¥éª¤ 4.3ï¼šæ›´æ–°æœ¯è¯­åº“ä½¿ç”¨ç‚¹
- **æ–‡ä»¶**: `utils.py`
- **å—å½±å“çš„å‡½æ•°**:
  - `translate_text()` ç¬¬ 268-271 è¡Œ
  - `call_deepl_api()` ç¬¬ 337-340 è¡Œ
  - `call_deepl_api_batch()` ç¬¬ 402-414 è¡Œ
  - `translate_word_document()` ç¬¬ 574-578 è¡Œ
- **æ“ä½œ**: åœ¨ä½¿ç”¨ `GLOSSARY` å‰ç¡®ä¿å·²åˆå§‹åŒ–

**æ–¹æ¡ˆ Aï¼ˆæ¨èï¼‰: åœ¨æ¨¡å—åŠ è½½æ—¶åˆå§‹åŒ–**
```python
# åœ¨ load_glossary() å®šä¹‰ä¹‹åç«‹å³è°ƒç”¨
GLOSSARY = load_glossary()
```

**æ–¹æ¡ˆ B: æ‡’åŠ è½½æ¨¡å¼**
```python
def _get_glossary():
    global GLOSSARY
    if not GLOSSARY:
        GLOSSARY = load_glossary()
    return GLOSSARY
```

#### æ­¥éª¤ 4.4ï¼šç§»é™¤ translate_word_document ä¸­çš„åˆå¹¶é€»è¾‘
- **æ–‡ä»¶**: `utils.py`
- **ä½ç½®**: ç¬¬ 574-578 è¡Œ
- **ä¿®æ”¹å‰**:
```python
global GLOSSARY
external_glossary = load_glossary()
if external_glossary:
    GLOSSARY = {**GLOSSARY, **external_glossary}
```

- **ä¿®æ”¹å**:
```python
# æœ¯è¯­åº“å·²åœ¨æ¨¡å—åŠ è½½æ—¶åˆå§‹åŒ–ï¼Œæ— éœ€é‡å¤åŠ è½½
pass  # æˆ–ç›´æ¥åˆ é™¤è¿™æ®µä»£ç 
```

---

## éœ€æ±‚äº”ï¼šPPTç”ŸæˆåŠŸèƒ½

### åŠŸèƒ½è®¾è®¡

ç”¨æˆ·å¯ä»¥é€šè¿‡è¯¥é¡µé¢ï¼š
1. è¾“å…¥/ç²˜è´´ AI ç”Ÿæˆçš„ PPT å†…å®¹ï¼ˆåŒ…å«ç»“æ„æ ‡è®°å¦‚ "Slide 1"ã€"ç¬¬ä¸€é¡µ" ç­‰ï¼‰
2. ç³»ç»Ÿè‡ªåŠ¨è§£æå†…å®¹ï¼Œè¯†åˆ«æ¯é¡µçš„æ ‡é¢˜å’Œå†…å®¹
3. ç”Ÿæˆç©ºç™½æ ¼å¼çš„ .pptx æ–‡ä»¶ä¾›ä¸‹è½½

### å†…å®¹æ ¼å¼æ”¯æŒ

éœ€è¦æ”¯æŒè§£æä»¥ä¸‹æ ¼å¼ï¼š
```
# æ ¼å¼1ï¼šSlide N
Slide 1: æ ‡é¢˜
- å†…å®¹1
- å†…å®¹2

Slide 2: æ ‡é¢˜
...

# æ ¼å¼2ï¼šç¬¬Né¡µ
ç¬¬ä¸€é¡µï¼šæ ‡é¢˜
å†…å®¹...

ç¬¬äºŒé¡µï¼šæ ‡é¢˜
...

# æ ¼å¼3ï¼šæ•°å­—ç¼–å·
1. æ ‡é¢˜
   å†…å®¹...

2. æ ‡é¢˜
   ...
```

### æ­¥éª¤åˆ†è§£

#### æ­¥éª¤ 5.1ï¼šæ·»åŠ  python-pptx ä¾èµ–
- **æ–‡ä»¶**: `requirements.txt`
- **æ“ä½œ**: æ·»åŠ  `python-pptx` åº“

```
streamlit>=1.28.0
openai>=1.0.0
python-docx>=1.0.0
pdf2docx>=0.5.8
PyPDF2>=3.0.0
deepl>=1.27.0
python-pptx>=0.6.21
```

#### æ­¥éª¤ 5.2ï¼šåœ¨ utils.py ä¸­æ·»åŠ  PPT è§£æå‡½æ•°
- **æ–‡ä»¶**: `utils.py`
- **å‡½æ•°å**: `parse_ppt_content()`
- **åŠŸèƒ½**: è§£ææ–‡æœ¬å†…å®¹ï¼Œæå–æ¯é¡µçš„æ ‡é¢˜å’Œå†…å®¹

```python
import re
from typing import List, Dict

def parse_ppt_content(content: str) -> List[Dict[str, any]]:
    """
    è§£æ PPT å†…å®¹æ–‡æœ¬ï¼Œæå–æ¯é¡µçš„æ ‡é¢˜å’Œå†…å®¹
    
    æ”¯æŒçš„æ ¼å¼ï¼š
    - Slide 1: æ ‡é¢˜ / Slide 1 - æ ‡é¢˜
    - ç¬¬ä¸€é¡µï¼šæ ‡é¢˜ / ç¬¬1é¡µï¼šæ ‡é¢˜
    - 1. æ ‡é¢˜
    
    å‚æ•°:
        content (str): PPT å†…å®¹æ–‡æœ¬
    
    è¿”å›:
        List[Dict]: æ¯é¡µå†…å®¹åˆ—è¡¨ï¼Œæ ¼å¼ä¸º [{"title": "æ ‡é¢˜", "content": ["å†…å®¹1", "å†…å®¹2"]}, ...]
    """
    slides = []
    
    # å®šä¹‰åˆ†éš”æ¨¡å¼
    patterns = [
        r'(?:^|\n)(?:Slide\s*(\d+)|ç¬¬([ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹å\d]+)é¡µ|(\d+)\s*[\.ã€])[\s:ï¼š\-]*(.+?)(?=(?:\nSlide\s*\d+|\nç¬¬[ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹å\d]+é¡µ|\n\d+\s*[\.ã€]|\Z))',
    ]
    
    # ... è§£æé€»è¾‘
    
    return slides
```

#### æ­¥éª¤ 5.3ï¼šåœ¨ utils.py ä¸­æ·»åŠ  PPT ç”Ÿæˆå‡½æ•°
- **æ–‡ä»¶**: `utils.py`
- **å‡½æ•°å**: `generate_pptx()`
- **åŠŸèƒ½**: æ ¹æ®è§£æç»“æœç”Ÿæˆ PPTX æ–‡ä»¶

```python
from pptx import Presentation
from pptx.util import Inches, Pt
from pptx.enum.text import PP_ALIGN
import tempfile

def generate_pptx(slides: List[Dict[str, any]], output_path: str = None) -> str:
    """
    æ ¹æ®å¹»ç¯ç‰‡æ•°æ®ç”Ÿæˆ PPTX æ–‡ä»¶
    
    å‚æ•°:
        slides (List[Dict]): å¹»ç¯ç‰‡æ•°æ®åˆ—è¡¨
        output_path (str, optional): è¾“å‡ºæ–‡ä»¶è·¯å¾„ï¼Œå¦‚æœä¸º None åˆ™è‡ªåŠ¨ç”Ÿæˆ
    
    è¿”å›:
        str: ç”Ÿæˆçš„ PPTX æ–‡ä»¶è·¯å¾„
    """
    prs = Presentation()
    
    # è®¾ç½®å¹»ç¯ç‰‡å°ºå¯¸ (16:9)
    prs.slide_width = Inches(13.333)
    prs.slide_height = Inches(7.5)
    
    for slide_data in slides:
        # ä½¿ç”¨ç©ºç™½å¸ƒå±€
        slide_layout = prs.slide_layouts[6]  # ç©ºç™½å¸ƒå±€
        slide = prs.slides.add_slide(slide_layout)
        
        # æ·»åŠ æ ‡é¢˜
        title_box = slide.shapes.add_textbox(Inches(0.5), Inches(0.5), Inches(12), Inches(1))
        title_frame = title_box.text_frame
        title_para = title_frame.paragraphs[0]
        title_para.text = slide_data.get("title", "")
        title_para.font.size = Pt(32)
        title_para.font.bold = True
        
        # æ·»åŠ å†…å®¹
        content_items = slide_data.get("content", [])
        if content_items:
            content_box = slide.shapes.add_textbox(Inches(0.5), Inches(1.8), Inches(12), Inches(5))
            content_frame = content_box.text_frame
            content_frame.word_wrap = True
            
            for i, item in enumerate(content_items):
                if i == 0:
                    para = content_frame.paragraphs[0]
                else:
                    para = content_frame.add_paragraph()
                para.text = f"â€¢ {item}" if not item.startswith(("â€¢", "-", "Â·")) else item
                para.font.size = Pt(18)
                para.space_after = Pt(12)
    
    # ä¿å­˜æ–‡ä»¶
    if output_path is None:
        temp_dir = Path("temp")
        temp_dir.mkdir(exist_ok=True)
        output_path = str(temp_dir / f"generated_{uuid.uuid4()}.pptx")
    
    prs.save(output_path)
    return output_path
```

#### æ­¥éª¤ 5.4ï¼šæ›´æ–° pages/3_PPTç”Ÿæˆ.py é¡µé¢
- **æ–‡ä»¶**: `pages/3_PPTç”Ÿæˆ.py`
- **æ“ä½œ**: å®ç°å®Œæ•´çš„ UI å’ŒåŠŸèƒ½é€»è¾‘

```python
import streamlit as st
from utils import apply_custom_styles, parse_ppt_content, generate_pptx
from pathlib import Path

st.set_page_config(
    page_title="PPT ç”Ÿæˆ",
    page_icon="ğŸ“Š",
    layout="wide"
)

apply_custom_styles()

st.title("ğŸ“Š PPT ç”Ÿæˆ")
st.markdown("å°†æ–‡æœ¬å†…å®¹è½¬æ¢ä¸º PowerPoint æ¼”ç¤ºæ–‡ç¨¿")

# ä½¿ç”¨è¯´æ˜
with st.expander("ğŸ“– ä½¿ç”¨è¯´æ˜", expanded=False):
    st.markdown("""
    **æ”¯æŒçš„å†…å®¹æ ¼å¼ï¼š**
    
    ```
    Slide 1: ç¬¬ä¸€é¡µæ ‡é¢˜
    - å†…å®¹è¦ç‚¹1
    - å†…å®¹è¦ç‚¹2
    
    Slide 2: ç¬¬äºŒé¡µæ ‡é¢˜
    - æ›´å¤šå†…å®¹
    ```
    
    æˆ–è€…ï¼š
    
    ```
    ç¬¬ä¸€é¡µï¼šæ ‡é¢˜
    å†…å®¹...
    
    ç¬¬äºŒé¡µï¼šæ ‡é¢˜
    å†…å®¹...
    ```
    """)

# è¾“å…¥åŒºåŸŸ
st.subheader("ğŸ“ è¾“å…¥å†…å®¹")
ppt_content = st.text_area(
    "ç²˜è´´ PPT å†…å®¹",
    height=400,
    placeholder="åœ¨æ­¤ç²˜è´´ AI ç”Ÿæˆçš„ PPT å†…å®¹...\n\nç¤ºä¾‹ï¼š\nSlide 1: é¡¹ç›®ä»‹ç»\n- èƒŒæ™¯è¯´æ˜\n- ç›®æ ‡å®šä¹‰\n\nSlide 2: ä¸»è¦å†…å®¹\n- è¦ç‚¹ä¸€\n- è¦ç‚¹äºŒ"
)

# ç”ŸæˆæŒ‰é’®
if st.button("ğŸš€ ç”Ÿæˆ PPT", type="primary", use_container_width=True):
    if not ppt_content.strip():
        st.warning("âš ï¸ è¯·è¾“å…¥ PPT å†…å®¹")
    else:
        with st.spinner("æ­£åœ¨ç”Ÿæˆ PPT..."):
            try:
                # è§£æå†…å®¹
                slides = parse_ppt_content(ppt_content)
                
                if not slides:
                    st.error("âŒ æ— æ³•è§£æå†…å®¹ï¼Œè¯·æ£€æŸ¥æ ¼å¼")
                else:
                    st.info(f"ğŸ“‘ å·²è¯†åˆ« {len(slides)} é¡µå¹»ç¯ç‰‡")
                    
                    # é¢„è§ˆ
                    with st.expander("ğŸ“‹ å†…å®¹é¢„è§ˆ", expanded=True):
                        for i, slide in enumerate(slides, 1):
                            st.markdown(f"**ç¬¬ {i} é¡µ: {slide.get('title', 'æ— æ ‡é¢˜')}**")
                            for item in slide.get('content', []):
                                st.markdown(f"  - {item}")
                            st.markdown("---")
                    
                    # ç”Ÿæˆ PPTX
                    output_path = generate_pptx(slides)
                    
                    # æä¾›ä¸‹è½½
                    with open(output_path, "rb") as f:
                        st.download_button(
                            label="ğŸ“¥ ä¸‹è½½ PPT æ–‡ä»¶",
                            data=f.read(),
                            file_name="generated_presentation.pptx",
                            mime="application/vnd.openxmlformats-officedocument.presentationml.presentation",
                            type="primary",
                            use_container_width=True
                        )
                    
                    st.success("âœ… PPT ç”ŸæˆæˆåŠŸï¼")
                    
            except Exception as e:
                st.error(f"âŒ ç”Ÿæˆå¤±è´¥: {str(e)}")
```

#### æ­¥éª¤ 5.5ï¼šæ›´æ–° app.py ä¸­çš„ PPT ç”Ÿæˆé¡µé¢
- **æ–‡ä»¶**: `app.py`
- **ä½ç½®**: ç¬¬ 126-134 è¡Œ
- **æ“ä½œ**: å°†å ä½ç¬¦æ›¿æ¢ä¸ºå®é™…åŠŸèƒ½ï¼ˆå‚è€ƒ pages/3_PPTç”Ÿæˆ.py çš„ç®€åŒ–ç‰ˆæœ¬ï¼‰

---

## éœ€æ±‚å…­ï¼šUIé—ªçƒä¿®å¤

### é—®é¢˜åˆ†æ

**ç°è±¡**: å¯åŠ¨åº”ç”¨æ—¶ï¼Œé¡µé¢ä¼šçŸ­æš‚æ˜¾ç¤ºæ—§ç‰ˆ UIï¼ˆå¯èƒ½æ˜¯é»˜è®¤ Streamlit æ ·å¼æˆ–æœªåŠ è½½çš„çŠ¶æ€ï¼‰ï¼Œç„¶åæ‰è·³è½¬åˆ°æ­£å¸¸çš„è‡ªå®šä¹‰æ ·å¼ UIã€‚

**åŸå› **: 
1. è‡ªå®šä¹‰æ ·å¼ (`apply_custom_styles()`) åœ¨é¡µé¢æ¸²æŸ“åæ‰åº”ç”¨
2. é¡µé¢ç»„ä»¶å…ˆæ¸²æŸ“ï¼ŒCSS åæ³¨å…¥ï¼Œå¯¼è‡´è§†è§‰é—ªçƒ
3. å¤šé¡µé¢åº”ç”¨ä¸­ï¼Œæ¯ä¸ªé¡µé¢å¯èƒ½ç‹¬ç«‹åŠ è½½æ ·å¼

### æ­¥éª¤åˆ†è§£

#### æ­¥éª¤ 6.1ï¼šåˆ†æå½“å‰æ ·å¼åŠ è½½æœºåˆ¶
- **æ–‡ä»¶**: `utils.py` ä¸­çš„ `apply_custom_styles()` å‡½æ•°
- **æ“ä½œ**: æ£€æŸ¥æ ·å¼æ³¨å…¥æ—¶æœºå’Œæ–¹å¼
- **ç›®æ ‡**: ç¡®å®šé—ªçƒçš„æ ¹æœ¬åŸå› 

#### æ­¥éª¤ 6.2ï¼šä¼˜åŒ–æ ·å¼åŠ è½½é¡ºåº
- **æ“ä½œ**: ç¡®ä¿ `st.set_page_config()` æ˜¯æ¯ä¸ªé¡µé¢çš„ç¬¬ä¸€ä¸ª Streamlit å‘½ä»¤
- **æ–‡ä»¶**: æ£€æŸ¥æ‰€æœ‰é¡µé¢æ–‡ä»¶
  - `app.py`
  - `pages/1_æ–‡æœ¬ç¿»è¯‘.py`
  - `pages/2_æ–‡æ¡£ç¿»è¯‘.py`
  - `pages/3_PPTç”Ÿæˆ.py`
  - `pages/4_é‚®ä»¶åŠ©æ‰‹.py`ï¼ˆå¦‚å·²åˆ›å»ºï¼‰

#### æ­¥éª¤ 6.3ï¼šä½¿ç”¨ CSS éšè—åˆå§‹é—ªçƒ
- **æ–¹æ¡ˆ**: æ·»åŠ åˆå§‹éšè—æ ·å¼ï¼Œå¾…å†…å®¹åŠ è½½å®Œæˆåæ˜¾ç¤º
- **å®ç°**: åœ¨ `apply_custom_styles()` ä¸­æ·»åŠ è¿‡æ¸¡æ•ˆæœ

```python
def apply_custom_styles():
    st.markdown("""
    <style>
    /* é˜²æ­¢é—ªçƒï¼šåˆå§‹çŠ¶æ€è®¾ç½®æ¸å…¥åŠ¨ç”» */
    .main .block-container {
        animation: fadeIn 0.3s ease-in-out;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    
    /* å…¶ä»–è‡ªå®šä¹‰æ ·å¼... */
    </style>
    """, unsafe_allow_html=True)
```

#### æ­¥éª¤ 6.4ï¼šç»Ÿä¸€é¡µé¢åˆå§‹åŒ–é€»è¾‘
- **æ“ä½œ**: åˆ›å»ºç»Ÿä¸€çš„é¡µé¢åˆå§‹åŒ–å‡½æ•°ï¼Œç¡®ä¿æ ·å¼åœ¨æœ€æ—©æ—¶æœºåº”ç”¨
- **æ–‡ä»¶**: `utils.py`

```python
def init_page(title: str, icon: str, layout: str = "wide"):
    """
    ç»Ÿä¸€çš„é¡µé¢åˆå§‹åŒ–å‡½æ•°
    ç¡®ä¿é…ç½®å’Œæ ·å¼æŒ‰æ­£ç¡®é¡ºåºåŠ è½½
    """
    st.set_page_config(
        page_title=title,
        page_icon=icon,
        layout=layout
    )
    apply_custom_styles()
```

#### æ­¥éª¤ 6.5ï¼šæ›´æ–°æ‰€æœ‰é¡µé¢ä½¿ç”¨ç»Ÿä¸€åˆå§‹åŒ–
- **æ“ä½œ**: å°†æ‰€æœ‰é¡µé¢çš„ `st.set_page_config()` + `apply_custom_styles()` æ›¿æ¢ä¸º `init_page()`
- **æ–‡ä»¶**: æ‰€æœ‰é¡µé¢æ–‡ä»¶

#### æ­¥éª¤ 6.6ï¼šæµ‹è¯•éªŒè¯
- **æµ‹è¯•é¡¹**:
  - å†·å¯åŠ¨åº”ç”¨ï¼Œè§‚å¯Ÿæ˜¯å¦æœ‰é—ªçƒ
  - é¡µé¢åˆ‡æ¢æ—¶ï¼Œè§‚å¯Ÿæ˜¯å¦æœ‰é—ªçƒ
  - åˆ·æ–°é¡µé¢æ—¶ï¼Œè§‚å¯Ÿæ˜¯å¦æœ‰é—ªçƒ

---

## æ‰§è¡Œé¡ºåºå»ºè®®

å»ºè®®æŒ‰ä»¥ä¸‹é¡ºåºæ‰§è¡Œï¼Œä»¥æœ€å°åŒ–é£é™©ï¼š

### é˜¶æ®µä¸€ï¼šä»£ç æ¸…ç†ä¸æœ¯è¯­åº“é‡æ„ï¼ˆä½é£é™©ï¼‰âœ… å·²å®Œæˆ
1. âœ… æ­¥éª¤ 2.1ï¼šæ¸…ç† utils.py æ­»ä»£ç 
2. âœ… æ­¥éª¤ 2.2ï¼šæ¸…ç†è°ƒè¯• print è¯­å¥
3. âœ… æ­¥éª¤ 2.3ï¼šæ¸…ç†æ®‹ç•™æ³¨é‡Š
4. âœ… æ­¥éª¤ 2.4ï¼šæ¸…ç†æ–‡ä»¶æœ«å°¾ç©ºè¡Œ
5. âœ… æ­¥éª¤ 2.5ï¼šæ·»åŠ  ai_service.py è¯´æ˜æ³¨é‡Š
6. âœ… æ­¥éª¤ 4.1ï¼šæ¸…ç† glossary.json æœ«å°¾ç©ºè¡Œ
7. âœ… æ­¥éª¤ 4.2ï¼šç§»é™¤ utils.py ä¸­çš„ç¡¬ç¼–ç  GLOSSARY
8. âœ… æ­¥éª¤ 4.3ï¼šæ›´æ–°æœ¯è¯­åº“åˆå§‹åŒ–é€»è¾‘
9. âœ… æ­¥éª¤ 4.4ï¼šç§»é™¤é‡å¤çš„åŠ è½½é€»è¾‘

### é˜¶æ®µäºŒï¼šå¢åŠ ä¸­æ–‡é€‰é¡¹ï¼ˆä¸­é£é™©ï¼‰âœ… å·²å®Œæˆ
10. âœ… æ­¥éª¤ 3.1ï¼šæ›´æ–° `_get_deepl_lang_code()` å‡½æ•°
11. âœ… æ­¥éª¤ 3.2ï¼šæ›´æ–° app.py è¯­è¨€é€‰é¡¹
12. âœ… æ­¥éª¤ 3.3ï¼šæ›´æ–° pages/1_æ–‡æœ¬ç¿»è¯‘.py è¯­è¨€é€‰é¡¹
13. âœ… æ­¥éª¤ 3.4ï¼šæ›´æ–° pages/2_æ–‡æ¡£ç¿»è¯‘.py è¯­è¨€é€‰é¡¹
14. âœ… æµ‹è¯•ä¸­æ–‡ç¿»è¯‘åŠŸèƒ½

### é˜¶æ®µä¸‰ï¼šPPT ç”ŸæˆåŠŸèƒ½ï¼ˆæ–°åŠŸèƒ½ï¼‰âœ… å·²å®Œæˆ
15. âœ… æ­¥éª¤ 5.1ï¼šæ·»åŠ  python-pptx ä¾èµ–
16. âœ… æ­¥éª¤ 5.2ï¼šæ·»åŠ  `parse_ppt_content()` å‡½æ•°
17. âœ… æ­¥éª¤ 5.3ï¼šæ·»åŠ  `generate_pptx()` å‡½æ•°
18. âœ… æ­¥éª¤ 5.4ï¼šæ›´æ–° pages/3_PPTç”Ÿæˆ.py é¡µé¢
19. âœ… æ­¥éª¤ 5.5ï¼šæ›´æ–° app.py ä¸­çš„ PPT ç”Ÿæˆé¡µé¢
20. âœ… æµ‹è¯• PPT ç”ŸæˆåŠŸèƒ½

### é˜¶æ®µå››ï¼šé‚®ä»¶åŠ©æ‰‹é¡µé¢ï¼ˆæ–°åŠŸèƒ½ï¼‰âœ… å·²å®Œæˆ
21. âœ… æ­¥éª¤ 1.1ï¼šåˆ›å»º pages/4_é‚®ä»¶åŠ©æ‰‹.py åŸºç¡€æ¡†æ¶
22. âœ… æ­¥éª¤ 1.2ï¼šè®¾è®¡ UI å¸ƒå±€
23. âœ… æ­¥éª¤ 1.3ï¼šåœ¨ utils.py ä¸­æ·»åŠ  `generate_email_draft()` å‡½æ•°
24. âœ… æ­¥éª¤ 1.4ï¼šå®ç°ç”Ÿæˆé€»è¾‘
25. âœ… æ­¥éª¤ 1.5ï¼šæ·»åŠ å¤åˆ¶åŠŸèƒ½
26. âœ… æ­¥éª¤ 1.6ï¼šæ›´æ–° app.py ä¾§è¾¹æ å¯¼èˆª
27. âœ… æµ‹è¯•é‚®ä»¶åŠ©æ‰‹åŠŸèƒ½

### é˜¶æ®µäº”ï¼šUI é—ªçƒä¿®å¤ï¼ˆä¼˜åŒ–ä½“éªŒï¼‰âœ… å·²å®Œæˆ
28. âœ… æ­¥éª¤ 6.1ï¼šåˆ†æå½“å‰æ ·å¼åŠ è½½æœºåˆ¶
29. âœ… æ­¥éª¤ 6.2ï¼šä¼˜åŒ–æ ·å¼åŠ è½½é¡ºåº
30. âœ… æ­¥éª¤ 6.3ï¼šä½¿ç”¨ CSS éšè—åˆå§‹é—ªçƒ
31. âœ… æ­¥éª¤ 6.4ï¼šç»Ÿä¸€é¡µé¢åˆå§‹åŒ–é€»è¾‘
32. âœ… æ­¥éª¤ 6.5ï¼šæ›´æ–°æ‰€æœ‰é¡µé¢ä½¿ç”¨ç»Ÿä¸€åˆå§‹åŒ–
33. âœ… æ­¥éª¤ 6.6ï¼šæµ‹è¯•éªŒè¯

---

## æµ‹è¯•è®¡åˆ’

### æœ¯è¯­åº“æµ‹è¯•
| æµ‹è¯•ç”¨ä¾‹ | æ“ä½œ | é¢„æœŸç»“æœ |
|---------|------|---------|
| glossary.json å­˜åœ¨ | ç¿»è¯‘æœ¯è¯­åº“ä¸­çš„è¯ | ç›´æ¥è¿”å›æœ¯è¯­åº“ç¿»è¯‘ |
| glossary.json ä¸å­˜åœ¨ | ç¿»è¯‘ä»»æ„è¯ | è°ƒç”¨ DeepL API |
| glossary.json æ ¼å¼é”™è¯¯ | åŠ è½½æœ¯è¯­åº“ | è¿”å›ç©ºå­—å…¸ï¼Œä¸æŠ¥é”™ |

### ä¸­æ–‡ç¿»è¯‘æµ‹è¯•
| æµ‹è¯•ç”¨ä¾‹ | è¾“å…¥ | é¢„æœŸè¾“å‡º |
|---------|------|---------|
| æ–‡æœ¬ç¿»è¯‘-è‹±è¯‘ä¸­ | "Hello World" | "ä½ å¥½ä¸–ç•Œ" |
| æ–‡æœ¬ç¿»è¯‘-æ—¥è¯‘ä¸­ | "ã“ã‚“ã«ã¡ã¯" | "ä½ å¥½" |
| æ–‡æ¡£ç¿»è¯‘-è‹±æ–‡æ–‡æ¡£ | è‹±æ–‡ .docx æ–‡ä»¶ | ä¸­æ–‡ç¿»è¯‘åçš„æ–‡æ¡£ |

### PPT ç”Ÿæˆæµ‹è¯•
| æµ‹è¯•ç”¨ä¾‹ | è¾“å…¥æ ¼å¼ | é¢„æœŸç»“æœ |
|---------|---------|---------|
| Slide N æ ¼å¼ | `Slide 1: æ ‡é¢˜\n- å†…å®¹` | æ­£ç¡®è§£æå¹¶ç”Ÿæˆ |
| ç¬¬Né¡µæ ¼å¼ | `ç¬¬ä¸€é¡µï¼šæ ‡é¢˜\nå†…å®¹` | æ­£ç¡®è§£æå¹¶ç”Ÿæˆ |
| æ•°å­—æ ¼å¼ | `1. æ ‡é¢˜\nå†…å®¹` | æ­£ç¡®è§£æå¹¶ç”Ÿæˆ |
| ç©ºå†…å®¹ | ç©ºå­—ç¬¦ä¸² | æ˜¾ç¤ºè­¦å‘Š |
| æ— æ³•è§£æ | æ— ç»“æ„æ–‡æœ¬ | æ˜¾ç¤ºé”™è¯¯æç¤º |

### é‚®ä»¶åŠ©æ‰‹æµ‹è¯•
| æµ‹è¯•ç”¨ä¾‹ | è¾“å…¥ | é¢„æœŸè¾“å‡º |
|---------|------|---------|
| å•†åŠ¡é‚®ä»¶-æ­£å¼ | ä¸»é¢˜+è¦ç‚¹ | æ ¼å¼è§„èŒƒçš„å•†åŠ¡é‚®ä»¶ |
| æ„Ÿè°¢ä¿¡-å‹å¥½ | ä¸»é¢˜+è¦ç‚¹ | è¯­æ°”å‹å¥½çš„æ„Ÿè°¢ä¿¡ |
| API é”™è¯¯å¤„ç† | æ— æ•ˆ API Key | å‹å¥½çš„é”™è¯¯æç¤º |

### UI é—ªçƒä¿®å¤æµ‹è¯•
| æµ‹è¯•ç”¨ä¾‹ | æ“ä½œ | é¢„æœŸç»“æœ |
|---------|------|---------|
| å†·å¯åŠ¨æµ‹è¯• | é¦–æ¬¡å¯åŠ¨åº”ç”¨ | æ— æ ·å¼é—ªçƒï¼Œç›´æ¥æ˜¾ç¤ºæ­£å¸¸ UI |
| é¡µé¢åˆ‡æ¢æµ‹è¯• | åœ¨ä¸åŒåŠŸèƒ½é¡µé¢é—´åˆ‡æ¢ | åˆ‡æ¢å¹³æ»‘ï¼Œæ— é—ªçƒ |
| é¡µé¢åˆ·æ–°æµ‹è¯• | åˆ·æ–°å½“å‰é¡µé¢ | æ— é—ªçƒï¼Œæ ·å¼ä¿æŒä¸€è‡´ |
| å¿«é€Ÿåˆ‡æ¢æµ‹è¯• | å¿«é€Ÿè¿ç»­åˆ‡æ¢é¡µé¢ | æ— å¼‚å¸¸é—ªçƒæˆ–æ ·å¼é”™ä¹± |

### å›å½’æµ‹è¯•
- [ ] æ–‡æœ¬ç¿»è¯‘åŠŸèƒ½æ­£å¸¸ï¼ˆè‹±è¯­ã€æ—¥è¯­ç­‰ï¼‰
- [ ] æ–‡æ¡£ç¿»è¯‘åŠŸèƒ½æ­£å¸¸
- [ ] ä¾§è¾¹æ å¯¼èˆªæ­£å¸¸
- [ ] é¡µé¢æ ·å¼æ­£å¸¸
- [ ] UI æ— é—ªçƒç°è±¡

---

## é™„å½•ï¼šsecrets.toml é…ç½®ç¤ºä¾‹

```toml
# .streamlit/secrets.toml

# DeepL API Key (ç¿»è¯‘åŠŸèƒ½)
DEEPL_API_KEY = "your-deepl-api-key-here"

# DeepSeek API Key (é‚®ä»¶åŠ©æ‰‹åŠŸèƒ½)
DEEPSEEK_API_KEY = "your-deepseek-api-key-here"
```

---

## å˜æ›´æ—¥å¿—

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´å†…å®¹ |
|-----|------|---------|
| v1.0 | 2024-12-29 | åˆå§‹è®¡åˆ’ï¼ˆ3 ä¸ªéœ€æ±‚ï¼‰ |
| v1.1 | 2024-12-29 | æ–°å¢éœ€æ±‚å››ï¼ˆæœ¯è¯­åº“é‡æ„ï¼‰å’Œéœ€æ±‚äº”ï¼ˆPPTç”Ÿæˆï¼‰ |
| v1.2 | 2024-12-29 | æ–°å¢éœ€æ±‚å…­ï¼ˆUIé—ªçƒä¿®å¤ï¼‰ï¼›æ ‡è®°é˜¶æ®µä¸€ã€é˜¶æ®µäºŒä¸ºå·²å®Œæˆ |
| v1.3 | 2024-12-29 | æ ‡è®°é˜¶æ®µå››ï¼ˆé‚®ä»¶åŠ©æ‰‹ï¼‰ä¸ºå·²å®Œæˆï¼›æç¤ºè¯å¾®è°ƒï¼šå¢åŠ çº¯æ–‡æœ¬è¾“å‡ºè¦æ±‚ |
| v1.4 | 2024-12-29 | å®Œæˆé˜¶æ®µäº”ï¼ˆUIé—ªçƒä¿®å¤ï¼‰ï¼šé‡å‘½åpagesç›®å½•ã€ä¼˜åŒ–CSSåŠ è½½ã€æ·»åŠ Streamlité…ç½® |

---

**æ–‡æ¡£ç»“æŸ**
